"use strict";(()=>{function dt({timelineWidth:k,minimapBarsData:v,minimapHeight:G,minimapBarHeight:W,minimapTodayX:ne,ganttScroll:Z,minimapSvg:V,minimapViewport:R,addDocListener:ae}){function pe(){let x=document.querySelector(".gantt-body .gantt-sticky-left"),L=document.querySelector(".gantt-container");x&&L&&L.style.setProperty("--sticky-left-width",x.offsetWidth+"px")}requestAnimationFrame(pe),V&&requestAnimationFrame(()=>{let x=G/(v.length+1);if(v.forEach((L,$)=>{let u=document.createElementNS("http://www.w3.org/2000/svg","rect");u.setAttribute("class",L.classes),u.setAttribute("x",(L.startPct*k).toString()),u.setAttribute("y",(x*($+.5)).toString()),u.setAttribute("width",Math.max(2,(L.endPct-L.startPct)*k).toString()),u.setAttribute("height",W.toString()),u.setAttribute("rx","1"),u.setAttribute("fill",L.color),V.insertBefore(u,R)}),ne>0&&ne<k){let L=document.createElementNS("http://www.w3.org/2000/svg","line");L.setAttribute("class","minimap-today"),L.setAttribute("x1",ne.toString()),L.setAttribute("y1","0"),L.setAttribute("x2",ne.toString()),L.setAttribute("y2",G.toString()),V.insertBefore(L,R)}});function ye(){if(!Z||!R)return;let x=Math.max(1,Z.scrollWidth-Z.clientWidth),L=Math.min(1,Z.scrollLeft/x),$=Math.min(1,Z.clientWidth/Z.scrollWidth),u=Math.max(20,$*k),ie=L*(k-u);R.setAttribute("x",ie.toString()),R.setAttribute("width",u.toString())}let H=!1,J=0;function _(x,L=!1){if(!Z||!V||!R)return;let $=V.getBoundingClientRect(),ie=parseFloat(R.getAttribute("width")||"0")/k*$.width,N=x.clientX-$.left;L?N-=J:N-=ie/2;let B=Math.max(0,Math.min(1,N/($.width-ie))),ee=Math.max(0,Z.scrollWidth-Z.clientWidth);Z.scrollLeft=B*ee}return V&&R&&(R.addEventListener("mousedown",x=>{x.stopPropagation(),H=!0;let L=V.getBoundingClientRect(),u=parseFloat(R.getAttribute("x")||"0")/k*L.width;J=x.clientX-L.left-u}),V.addEventListener("mousedown",x=>{if(x.target===R)return;H=!0;let L=V.getBoundingClientRect();J=parseFloat(R.getAttribute("width")||"0")/100*L.width/2,_(x,!0)}),ae("mousemove",x=>{H&&_(x,!0)}),ae("mouseup",()=>{H=!1})),{updateMinimapPosition:pe,updateMinimapViewport:ye}}function ut(k){let{vscode:v,menuUndo:G,menuRedo:W,addDocListener:ne,closeOnOutsideClick:Z,announce:V,saveState:R,updateUndoRedoButtons:ae,undoStack:pe,redoStack:ye,selectedIssues:H,clearSelection:J,allIssueBars:_,redmineBaseUrl:x,extendedRelationTypes:L,minDateMs:$,maxDateMs:u,timelineWidth:ie,dayWidth:N,barHeight:B,ganttScroll:ee,snapToDay:te,focusOnDependencyChain:le,clearFocus:d,getFocusedIssueId:p,scrollToAndHighlight:h,setAllowScrollChange:q}=k;function l(n,a,s){document.querySelector(".relation-picker")?.remove();let r=H.size>1&&H.has(s),i=r?Array.from(H).map(I=>parseInt(I)):[parseInt(s)],A=document.createElement("div");A.className="relation-picker";let M=160,E=180,K=Math.min(n,window.innerWidth-M-10),D=Math.min(a,window.innerHeight-E-10);A.style.left=Math.max(10,K)+"px",A.style.top=Math.max(10,D)+"px";let F=document.createElement("div");F.style.padding="6px 12px",F.style.fontSize="11px",F.style.opacity="0.7",F.textContent=r?i.length+" issues selected":"#"+s,A.appendChild(F),(r?[{label:"Set % Done...",command:"bulkSetDoneRatio",bulk:!0},{label:"Clear Selection",command:"clearSelection",local:!0}]:[{label:"Update Issue...",command:"openIssue"},{label:"Open in Browser",command:"openInBrowser"},{label:"Show in Issues",command:"showInIssues"},{label:"Log Time",command:"logTime"},{label:"Set % Done",command:"setDoneRatio"},{label:"Toggle Auto-update %",command:"toggleAutoUpdate"},{label:"Toggle Ad-hoc Budget",command:"toggleAdHoc"},{label:"Toggle Precedence",command:"togglePrecedence"},{label:"Set Internal Estimate",command:"setInternalEstimate"},{label:"Copy Link",command:"copyLink",local:!0},{label:"Copy URL",command:"copyUrl"}]).forEach(I=>{let Y=document.createElement("button");Y.textContent=I.label,Y.addEventListener("click",async()=>{if(I.command==="copyLink"){let Ie=document.querySelector('.issue-bar[data-issue-id="'+s+'"]')?.dataset?.subject||"Issue #"+s,Ke=x+"/issues/"+s,Re='<a href="'+Ke+'">#'+s+" "+Ie+"</a>",Ye=Ke;try{await navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([Ye],{type:"text/plain"}),"text/html":new Blob([Re],{type:"text/html"})})]),v.postMessage({command:"showStatus",message:"Copied #"+s+" link"})}catch{await navigator.clipboard.writeText(Ye),v.postMessage({command:"showStatus",message:"Copied #"+s+" URL"})}}else I.local?J():I.bulk?v.postMessage({command:I.command,issueIds:i}):v.postMessage({command:I.command,issueId:parseInt(s)});A.remove()}),A.appendChild(Y)}),document.body.appendChild(A),Z(A)}function c(n){let a=$+n/ie*(u-$);return new Date(a).toISOString().slice(0,10)}function m(n){let a=$+n/ie*(u-$)-864e5;return new Date(a).toISOString().slice(0,10)}let C=document.getElementById("dragDateTooltip"),X=null;function ce(n){let a=new Date(n+"T00:00:00"),s=a.toLocaleDateString("en-US",{month:"short"}),r=a.getDate(),i=a.toLocaleDateString("en-US",{weekday:"short"});return s+" "+r+" ("+i+")"}function se(n,a){let s=new Date(n+"T00:00:00"),r=new Date(a+"T00:00:00"),i=s.toLocaleDateString("en-US",{month:"short"}),A=r.toLocaleDateString("en-US",{month:"short"});return i===A?i+" "+s.getDate()+"-"+r.getDate():i+" "+s.getDate()+"-"+A+" "+r.getDate()}function xe(n){C.textContent=n,C.style.display="block",X=n}function qe(n){n!==X&&(C.textContent=n,X=n)}function Le(n,a){let s=a-28,r=!1;s<40&&(s=a+20,r=!0),C.style.left=n+"px",C.style.top=s+"px",C.classList.toggle("flipped",r)}function Se(){C.style.display="none",X=null}let Be=4;function U(n,a,s,r,i){let A=s>n,E=Math.abs(s-n)<30,K=Math.abs(a-r)<5,D;if(K&&A)D="M "+n+" "+a+" H "+s;else if(!K&&E){let I=(a+r)/2;D="M "+n+" "+a+" H "+(n+20)+" V "+I+" H "+(s-20)+" V "+r+" H "+s}else if(A){let S=(n+s)/2;D="M "+n+" "+a+" H "+S+" V "+r+" H "+s}else if(K){let I=a-B;D="M "+n+" "+a+" V "+I+" H "+(s-12)+" V "+r+" H "+s}else{let I=(a+r)/2;D="M "+n+" "+a+" V "+I+" H "+(s-12)+" V "+r+" H "+s}let F="M "+(s-Be)+" "+(r-Be*.6)+" L "+s+" "+r+" L "+(s-Be)+" "+(r+Be*.6);return{path:D,arrowHead:F}}function Ae(n){let a=[],s='.dependency-arrow[data-from="'+n+'"], .dependency-arrow[data-to="'+n+'"]';return document.querySelectorAll(s).forEach(r=>{let i=r.getAttribute("data-from"),A=r.getAttribute("data-to"),E=(r.getAttribute("class")||"").match(/rel-(\w+)/),K=E?E[1]:"relates",D=["blocks","precedes","finish_to_start","start_to_start","finish_to_finish","start_to_finish"].includes(K),F=document.querySelector('.issue-bar[data-issue-id="'+i+'"]'),S=document.querySelector('.issue-bar[data-issue-id="'+A+'"]');!F||!S||a.push({element:r,fromId:i,toId:A,isScheduling:D,fromBar:F,toBar:S,linePath:r.querySelector(".arrow-line"),hitPath:r.querySelector(".arrow-hit-area"),headPath:r.querySelector(".arrow-head")})}),a}function re(n,a,s,r){n.forEach(i=>{let A=i.fromId==a?s:parseFloat(i.fromBar.dataset.startX),M=i.fromId==a?r:parseFloat(i.fromBar.dataset.endX),E=parseFloat(i.fromBar.dataset.centerY),K=i.toId==a?s:parseFloat(i.toBar.dataset.startX),D=i.toId==a?r:parseFloat(i.toBar.dataset.endX),F=parseFloat(i.toBar.dataset.centerY),S,I,Y,me;i.isScheduling?(S=M+2,I=E,Y=K-2,me=F):(S=(A+M)/2,I=E,Y=(K+D)/2,me=F);let{path:Ie,arrowHead:Ke}=U(S,I,Y,me,i.isScheduling);i.linePath&&i.linePath.setAttribute("d",Ie),i.hitPath&&i.hitPath.setAttribute("d",Ie),i.headPath&&i.headPath.setAttribute("d",Ke)})}let ve=document.getElementById("dragConfirmOverlay"),Te=document.getElementById("dragConfirmMessage"),Fe=document.getElementById("dragConfirmOk"),Je=document.getElementById("dragConfirmCancel"),de=null;function ue(n,a,s){!ve||!Te||(Te.textContent=n,de={onConfirm:a,onCancel:s},q(!0),ve.style.display="flex",Fe&&Fe.focus())}function De(){ve&&(ve.style.display="none"),de=null}function He(){ee&&we&&(ee.scrollLeft=we.left,ee.scrollTop=we.top),we=null}Fe?.addEventListener("click",()=>{de?.onConfirm&&de.onConfirm(),we=null,De()}),Je?.addEventListener("click",()=>{de?.onCancel&&de.onCancel(),He(),De()}),ve?.addEventListener("click",n=>{n.target===ve&&(de?.onCancel&&de.onCancel(),He(),De())}),ne("keydown",n=>{de&&(n.key==="Escape"?(n.preventDefault(),de.onCancel&&de.onCancel(),He(),De()):n.key==="Enter"&&(n.preventDefault(),de.onConfirm&&de.onConfirm(),we=null,De()))});let y=null,we=null,$e=!1;document.querySelectorAll(".drag-handle").forEach(n=>{n.addEventListener("mousedown",a=>{a.preventDefault(),a.stopPropagation(),we={left:ee?.scrollLeft,top:ee?.scrollTop};let s=n.closest(".issue-bar"),r=n.classList.contains("drag-left"),i=parseInt(s.dataset.issueId),A=parseFloat(s.dataset.startX),M=parseFloat(s.dataset.endX),E=s.dataset.startDate||null,K=s.dataset.dueDate||null,D=s.querySelector(".bar-outline"),F=s.querySelector(".bar-main"),S=s.querySelector(".drag-left"),I=s.querySelector(".drag-right");s.classList.add("dragging");let Y=s.querySelector(".bar-labels"),me=Y?.classList.contains("labels-left"),Ie=Ae(i),Ke=s.querySelector(".link-handle");y={issueId:i,isLeft:r,isMove:!1,initialMouseX:a.clientX,startX:A,endX:M,oldStartDate:E,oldDueDate:K,barOutline:D,barMain:F,leftHandle:S,rightHandle:I,bar:s,barLabels:Y,labelsOnLeft:me,connectedArrows:Ie,linkHandle:Ke};let Re=r?A:M,Ye=r?E:K;Ye&&(xe((r?"Start: ":"Due: ")+ce(Ye)),Le(a.clientX,a.clientY))})}),document.querySelectorAll(".bar-outline").forEach(n=>{n.addEventListener("mousedown",a=>{if(a.target.classList.contains("drag-handle")||a.ctrlKey||a.metaKey||a.shiftKey)return;a.preventDefault(),a.stopPropagation(),we={left:ee?.scrollLeft,top:ee?.scrollTop};let s=n.closest(".issue-bar");if(!s)return;let r=s.dataset.issueId,i=H.size>1&&H.has(r),M=(i?_.filter(S=>H.has(S.dataset.issueId)):[s]).map(S=>({issueId:S.dataset.issueId,startX:parseFloat(S.dataset.startX),endX:parseFloat(S.dataset.endX),oldStartDate:S.dataset.startDate||null,oldDueDate:S.dataset.dueDate||null,barOutline:S.querySelector(".bar-outline"),barMain:S.querySelector(".bar-main"),leftHandle:S.querySelector(".drag-left"),rightHandle:S.querySelector(".drag-right"),bar:S,barLabels:S.querySelector(".bar-labels"),labelsOnLeft:S.querySelector(".bar-labels")?.classList.contains("labels-left"),connectedArrows:Ae(S.dataset.issueId),linkHandle:S.querySelector(".link-handle")}));M.forEach(S=>S.bar.classList.add("dragging"));let E=s.querySelector(".bar-labels"),K=E?.classList.contains("labels-left"),D=Ae(r),F=s.querySelector(".link-handle");y={issueId:parseInt(r),isLeft:!1,isMove:!0,isBulkDrag:i,bulkBars:M,initialMouseX:a.clientX,startX:parseFloat(s.dataset.startX),endX:parseFloat(s.dataset.endX),oldStartDate:s.dataset.startDate||null,oldDueDate:s.dataset.dueDate||null,barOutline:n,barMain:s.querySelector(".bar-main"),leftHandle:s.querySelector(".drag-left"),rightHandle:s.querySelector(".drag-right"),bar:s,barLabels:E,labelsOnLeft:K,connectedArrows:D,linkHandle:F},!i&&s.dataset.startDate&&s.dataset.dueDate&&(xe(se(s.dataset.startDate,s.dataset.dueDate)),Le(a.clientX,a.clientY))})});let g=null,w=null,T=null;function j(){g&&(g.fromBar.classList.remove("linking-source"),document.querySelectorAll(".link-target").forEach(n=>n.classList.remove("link-target")),w&&(w.remove(),w=null),g=null,T=null,document.body.classList.remove("cursor-crosshair"))}function be(n,a,s,r){document.querySelector(".relation-picker")?.remove();let i=document.createElement("div");i.className="relation-picker";let A=180,M=200,E=Math.min(n,window.innerWidth-A-10),K=Math.min(a,window.innerHeight-M-10);i.style.left=Math.max(10,E)+"px",i.style.top=Math.max(10,K)+"px";let D=[{value:"blocks",label:"\u{1F6AB} Blocks",cssClass:"rel-line-blocks",tooltip:"Target cannot be closed until this issue is closed"},{value:"precedes",label:"\u27A1\uFE0F Precedes",cssClass:"rel-line-scheduling",tooltip:"This issue must complete before target can start"},{value:"relates",label:"\u{1F517} Relates to",cssClass:"rel-line-informational",tooltip:"Simple link between issues (no constraints)"},{value:"duplicates",label:"\u{1F4CB} Duplicates",cssClass:"rel-line-informational",tooltip:"Closing target will automatically close this issue"},{value:"copied_to",label:"\u{1F4C4} Copied to",cssClass:"rel-line-informational",tooltip:"This issue was copied to create the target issue"}],F=[{value:"finish_to_start",label:"\u23E9 Finish\u2192Start",cssClass:"rel-line-scheduling",tooltip:"Target starts after this issue finishes (FS)"},{value:"start_to_start",label:"\u25B6\uFE0F Start\u2192Start",cssClass:"rel-line-scheduling",tooltip:"Target starts when this issue starts (SS)"},{value:"finish_to_finish",label:"\u23F9\uFE0F Finish\u2192Finish",cssClass:"rel-line-scheduling",tooltip:"Target finishes when this issue finishes (FF)"},{value:"start_to_finish",label:"\u23EA Start\u2192Finish",cssClass:"rel-line-scheduling",tooltip:"Target finishes when this issue starts (SF)"}];(L?[...D,...F]:D).forEach(I=>{let Y=document.createElement("button"),me=document.createElement("span");me.className="color-swatch "+I.cssClass,Y.appendChild(me),Y.appendChild(document.createTextNode(I.label)),Y.title=I.tooltip,Y.addEventListener("click",()=>{R(),v.postMessage({command:"createRelation",issueId:s,targetIssueId:r,relationType:I.value}),i.remove()}),i.appendChild(Y)}),document.body.appendChild(i),Z(i)}let ke=".drag-handle, .link-handle, .bar-outline, .blocks-badge-group, .blocker-badge, .progress-badge-group, .flex-badge-group";document.querySelectorAll(".issue-bar").forEach(n=>{n.addEventListener("click",a=>{a.target.closest(ke)||y||g||$e||(p()&&d(),h(n.dataset.issueId))}),n.addEventListener("dblclick",a=>{y||g||$e||(a.preventDefault(),le(n.dataset.issueId))})});function Xe(n,a){if(document.querySelectorAll(".dependency-arrow.selected").forEach(r=>r.classList.remove("selected")),document.querySelectorAll(".arrow-connected").forEach(r=>r.classList.remove("arrow-connected")),n.length===0)return;document.body.classList.add("arrow-selection-mode");let s=new Set;n.forEach(r=>{r.classList.add("selected"),s.add(r.dataset.from),s.add(r.dataset.to)}),s.forEach(r=>{document.querySelectorAll(`.issue-bar[data-issue-id="${r}"], .issue-label[data-issue-id="${r}"]`).forEach(i=>i.classList.add("arrow-connected"))}),V(`Highlighted ${n.length} dependency arrow(s) for #${a}`)}document.querySelectorAll(".blocks-badge-group").forEach(n=>{n.addEventListener("mousedown",a=>{a.preventDefault(),a.stopPropagation()}),n.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation();let s=n.closest(".issue-bar");if(!s)return;let r=s.dataset.issueId,i=Array.from(document.querySelectorAll(`.dependency-arrow[data-from="${r}"]`));Xe(i,r)})}),document.querySelectorAll(".blocker-badge").forEach(n=>{n.addEventListener("mousedown",a=>{a.preventDefault(),a.stopPropagation()}),n.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation();let s=n.closest(".issue-bar");if(!s)return;let r=s.dataset.issueId,i=Array.from(document.querySelectorAll(`.dependency-arrow[data-to="${r}"]`));Xe(i,r)})});let O=Array.from(document.querySelectorAll(".issue-bar")),Pe=10;O.forEach((n,a)=>{n.addEventListener("keydown",s=>{if(s.key==="Enter"||s.key===" ")s.preventDefault(),h(n.dataset.issueId);else if(s.key==="ArrowDown"&&a<O.length-1)s.preventDefault(),O[a+1].focus(),V(`Issue ${O[a+1].getAttribute("aria-label")}`);else if(s.key==="ArrowUp"&&a>0)s.preventDefault(),O[a-1].focus(),V(`Issue ${O[a-1].getAttribute("aria-label")}`);else if(s.key==="Home")s.preventDefault(),O[0].focus(),V(`First issue: ${O[0].getAttribute("aria-label")}`);else if(s.key==="End")s.preventDefault(),O[O.length-1].focus(),V(`Last issue: ${O[O.length-1].getAttribute("aria-label")}`);else if(s.key==="PageDown"){s.preventDefault();let r=Math.min(a+Pe,O.length-1);O[r].focus(),V(`Issue ${O[r].getAttribute("aria-label")}`)}else if(s.key==="PageUp"){s.preventDefault();let r=Math.max(a-Pe,0);O[r].focus(),V(`Issue ${O[r].getAttribute("aria-label")}`)}else if(s.key==="Tab"&&s.shiftKey){let r=n.dataset.issueId,i=document.querySelector(`.issue-label[data-issue-id="${r}"]`);i&&(s.preventDefault(),i.focus(),V(`Label for issue #${r}`))}})}),document.querySelectorAll(".link-handle").forEach(n=>{n.addEventListener("mousedown",a=>{a.stopPropagation(),a.preventDefault();let s=n.closest(".issue-bar"),r=parseInt(s.dataset.issueId),i=parseFloat(n.dataset.cx),A=parseFloat(n.dataset.cy);s.classList.add("linking-source"),document.body.classList.add("cursor-crosshair");let M=document.querySelector("#ganttTimeline svg");if(!document.getElementById("temp-arrow-head")){let E=document.createElementNS("http://www.w3.org/2000/svg","defs");E.innerHTML=`
            <marker id="temp-arrow-head" markerWidth="10" markerHeight="7"
                    refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
              <polygon points="0 0, 10 3.5, 0 7" fill="var(--vscode-focusBorder)"/>
            </marker>`,M.insertBefore(E,M.firstChild)}w=document.createElementNS("http://www.w3.org/2000/svg","path"),w.classList.add("temp-link-arrow"),w.setAttribute("stroke","var(--vscode-focusBorder)"),w.setAttribute("stroke-width","2"),w.setAttribute("fill","none"),w.setAttribute("marker-end","url(#temp-arrow-head)"),M.appendChild(w),g={fromId:r,fromBar:s,startX:i,startY:A}})}),ne("keydown",n=>{if(n.key==="Escape"){let a=document.querySelector(".relation-picker");if(a){n.stopImmediatePropagation(),a.remove();return}if(g){n.stopImmediatePropagation(),j();return}p()&&(n.stopImmediatePropagation(),d(),V("Focus cleared"))}});let We=!1,fe=null;ne("mousemove",n=>{!y&&!g||(fe=n,!We&&(We=!0,requestAnimationFrame(()=>{We=!1;let a=fe;if(a){if(y){let s=a.clientX-y.initialMouseX;if(y.isMove&&y.isBulkDrag&&y.bulkBars){let r=te(s)-te(0);y.bulkBars.forEach(i=>{let A=i.endX-i.startX,M=Math.max(0,Math.min(i.startX+r,ie-A)),E=M+A,K=E-M;i.barOutline.setAttribute("x",M),i.barOutline.setAttribute("width",K),i.barMain&&(i.barMain.setAttribute("x",M),i.barMain.setAttribute("width",K));let D=i.leftHandle.querySelector("rect"),F=i.rightHandle.querySelector("rect");if(D&&D.setAttribute("x",M),F&&F.setAttribute("x",E-14),i.leftHandle.querySelectorAll(".drag-grip circle").forEach((S,I)=>S.setAttribute("cx",M+7)),i.rightHandle.querySelectorAll(".drag-grip circle").forEach((S,I)=>S.setAttribute("cx",E-7)),i.newStartX=M,i.newEndX=E,i.barLabels){let S=i.labelsOnLeft?M-i.startX:E-i.endX;i.barLabels.setAttribute("transform","translate("+S+", 0)")}i.connectedArrows&&re(i.connectedArrows,i.issueId,M,E),i.linkHandle&&i.linkHandle.querySelectorAll("circle").forEach(S=>S.setAttribute("cx",String(E+8)))}),y.snappedDelta=r}else{let r=y.startX,i=y.endX,A=y.endX-y.startX;y.isMove?(r=te(Math.max(0,Math.min(y.startX+s,ie-A))),i=r+A):y.isLeft?r=te(Math.max(0,Math.min(y.startX+s,y.endX-N))):i=te(Math.max(y.startX+N,Math.min(y.endX+s,ie)));let M=i-r;y.barOutline.setAttribute("x",r),y.barOutline.setAttribute("width",M),y.barMain&&(y.barMain.setAttribute("x",r),y.barMain.setAttribute("width",M));let E=y.leftHandle.querySelector("rect"),K=y.rightHandle.querySelector("rect");if(E&&E.setAttribute("x",r),K&&K.setAttribute("x",i-14),y.leftHandle.querySelectorAll(".drag-grip circle").forEach(D=>D.setAttribute("cx",r+7)),y.rightHandle.querySelectorAll(".drag-grip circle").forEach(D=>D.setAttribute("cx",i-7)),y.newStartX=r,y.newEndX=i,y.barLabels){let D=y.labelsOnLeft?r-y.startX:i-y.endX;y.barLabels.setAttribute("transform","translate("+D+", 0)")}if(y.connectedArrows&&re(y.connectedArrows,y.issueId,r,i),y.linkHandle&&y.linkHandle.querySelectorAll("circle").forEach(D=>D.setAttribute("cx",String(i+8))),y.isMove&&!y.isBulkDrag){let D=c(r),F=m(i),I=D!==y.oldStartDate?se(y.oldStartDate,y.oldDueDate)+" \u2192 "+se(D,F):se(D,F);qe(I),Le(a.clientX,a.clientY)}else if(!y.isMove){let D=y.isLeft?r:i,F=y.isLeft?c(D):m(D);qe((y.isLeft?"Start: ":"Due: ")+ce(F)),Le(a.clientX,a.clientY)}}}if(g&&w){let r=document.querySelector("#ganttTimeline svg").getBoundingClientRect(),i=a.clientX-r.left,A=a.clientY-r.top,M=`M ${g.startX} ${g.startY} L ${i} ${A}`;w.setAttribute("d",M);let E=document.elementFromPoint(a.clientX,a.clientY)?.closest(".issue-bar");T&&T!==E&&T.classList.remove("link-target"),E&&E!==g.fromBar?(E.classList.add("link-target"),T=E):T=null}}})))});function Oe(n){if(!n)return;let{bar:a,barOutline:s,barMain:r,leftHandle:i,rightHandle:A,barLabels:M,startX:E,endX:K,connectedArrows:D,issueId:F,linkHandle:S}=n,I=K-E;if(s&&(s.setAttribute("x",String(E)),s.setAttribute("width",String(I))),r&&(r.setAttribute("x",String(E)),r.setAttribute("width",String(I))),i){let Y=i.querySelector("rect");Y&&Y.setAttribute("x",String(E)),i.querySelectorAll(".drag-grip circle").forEach(me=>me.setAttribute("cx",E+7))}if(A){let Y=A.querySelector("rect");Y&&Y.setAttribute("x",String(K-14)),A.querySelectorAll(".drag-grip circle").forEach(me=>me.setAttribute("cx",K-7))}M&&M.removeAttribute("transform"),D&&D.length>0&&re(D,F,E,K),S&&S.querySelectorAll("circle").forEach(Y=>Y.setAttribute("cx",String(K+8))),a&&a.classList.remove("dragging")}ne("mouseup",n=>{if(y){let{issueId:a,isLeft:s,isMove:r,isBulkDrag:i,bulkBars:A,newStartX:M,newEndX:E,bar:K,startX:D,endX:F,oldStartDate:S,oldDueDate:I,barOutline:Y,barMain:me,leftHandle:Ie,rightHandle:Ke,barLabels:Re,connectedArrows:Ye}=y,ze={...y};if(i&&A&&r){A.forEach(z=>z.bar.classList.remove("dragging"));let Me=[];if(A.forEach(z=>{if(z.newStartX!==void 0&&z.newStartX!==z.startX){let Q=c(z.newStartX),Ce=m(z.newEndX);(Q!==z.oldStartDate||Ce!==z.oldDueDate)&&Me.push({issueId:parseInt(z.issueId),oldStartDate:z.oldStartDate,oldDueDate:z.oldDueDate,newStartDate:Q,newDueDate:Ce,barData:z})}}),Me.length>0){Se();let z="Move "+Me.length+" issue(s) to new dates?";ue(z,()=>{pe.push({type:"bulk",changes:Me.map(Q=>({issueId:Q.issueId,oldStartDate:Q.oldStartDate,oldDueDate:Q.oldDueDate,newStartDate:Q.newStartDate,newDueDate:Q.newDueDate}))}),ye.length=0,ae(),R(),Me.forEach(Q=>{v.postMessage({command:"updateDates",issueId:Q.issueId,startDate:Q.newStartDate,dueDate:Q.newDueDate})})},()=>{A.forEach(Q=>Oe(Q))})}else Se(),A.forEach(z=>Oe(z));y=null,$e=!0,requestAnimationFrame(()=>$e=!1);return}if(K.classList.remove("dragging"),Se(),M!==void 0||E!==void 0){let Me=null,z=null;r?M!==D&&(Me=c(M),z=m(E)):s?Me=M!==D?c(M):null:z=E!==F?m(E):null;let Q=Me&&Me!==S?Me:null,Ce=z&&z!==I?z:null;if(Q||Ce){let je="Issue #"+a+": ";Q&&Ce?je+=se(S,I)+" \u2192 "+se(Q,Ce):Q?je+="Start: "+ce(S)+" \u2192 "+ce(Q):je+="Due: "+ce(I)+" \u2192 "+ce(Ce),ue(je,()=>{pe.push({issueId:a,oldStartDate:Q?S:null,oldDueDate:Ce?I:null,newStartDate:Q,newDueDate:Ce}),ye.length=0,ae(),R(),v.postMessage({command:"updateDates",issueId:a,startDate:Q,dueDate:Ce})},()=>{Oe(ze)})}else Oe(ze)}else Oe(ze);y=null,$e=!0,requestAnimationFrame(()=>$e=!1)}if(g){let a=g.fromId;if(T){let s=parseInt(T.dataset.issueId);a!==s&&be(n.clientX,n.clientY,a,s)}j()}de||He()}),G?.addEventListener("click",()=>{if(G.hasAttribute("disabled")||pe.length===0)return;let n=pe.pop();ye.push(n),ae(),R(),n.type==="relation"?n.operation==="create"?v.postMessage({command:"undoRelation",operation:"delete",relationId:n.relationId,datesBefore:n.datesBefore}):v.postMessage({command:"undoRelation",operation:"create",issueId:n.issueId,targetIssueId:n.targetIssueId,relationType:n.relationType}):n.type==="bulk"?n.changes.forEach(a=>{v.postMessage({command:"updateDates",issueId:a.issueId,startDate:a.oldStartDate,dueDate:a.oldDueDate})}):v.postMessage({command:"updateDates",issueId:n.issueId,startDate:n.oldStartDate,dueDate:n.oldDueDate})}),W?.addEventListener("click",()=>{if(W.hasAttribute("disabled")||ye.length===0)return;let n=ye.pop();pe.push(n),ae(),R(),n.type==="relation"?n.operation==="create"?v.postMessage({command:"redoRelation",operation:"create",issueId:n.issueId,targetIssueId:n.targetIssueId,relationType:n.relationType}):v.postMessage({command:"redoRelation",operation:"delete",relationId:n.relationId}):n.type==="bulk"?n.changes.forEach(a=>{v.postMessage({command:"updateDates",issueId:a.issueId,startDate:a.newStartDate,dueDate:a.newDueDate})}):v.postMessage({command:"updateDates",issueId:n.issueId,startDate:n.newStartDate,dueDate:n.newDueDate})})}function ft(k){let{vscode:v,addDocListener:G,addWinListener:W,announce:ne,barHeight:Z,selectedCollapseKey:V}=k;document.querySelectorAll(".collapse-toggle").forEach(d=>{d.addEventListener("click",p=>{p.stopPropagation();let q=d.closest("[data-collapse-key]")?.dataset.collapseKey;q&&le(q)})}),document.getElementById("menuExpand")?.addEventListener("click",()=>{let p=document.getElementById("ganttScroll")?.dataset.allExpandableKeys,h=p?JSON.parse(p):[];v.postMessage({command:"expandAll",keys:h})}),document.getElementById("menuCollapse")?.addEventListener("click",()=>{v.postMessage({command:"collapseAll"})});let R=Array.from(document.querySelectorAll(".project-label, .issue-label, .time-group-label")),ae=null,pe=V??null;function ye(d){return!d.classList.contains("gantt-row-hidden")&&d.getAttribute("visibility")!=="hidden"}function H(d,p){let h=d+p;for(;h>=0&&h<R.length;){if(ye(R[h]))return{label:R[h],index:h};h+=p}return null}function J(d){let p=document.getElementById("ganttScroll"),h=document.querySelector(".gantt-header-row");if(!p||!d)return;let q=h?.getBoundingClientRect().height||60,l=d.closest(".gantt-row");if(!l)return;let c=l.getBoundingClientRect().top,m=l.getBoundingClientRect().height,C=p.getBoundingClientRect(),X=C.top+q,ce=C.bottom;c<X?p.scrollBy({top:c-X-4,behavior:"smooth"}):c+m>ce&&p.scrollBy({top:c+m-ce+4,behavior:"smooth"})}function _(d,p=!1,h=!1,q=!1){ae&&ae.classList.remove("active"),ae=d,d&&(d.classList.add("active"),q||d.focus(),h&&J(d),p||v.postMessage({command:"setSelectedKey",collapseKey:d.dataset.collapseKey}))}W("focus",()=>{ae&&ye(ae)&&ae.focus()}),G("keydown",d=>{d.key==="Escape"&&ae&&(ae.classList.remove("active"),ae.blur(),ae=null,v.postMessage({command:"setSelectedKey",collapseKey:null}))});let x=new Map,L=new Map,$=new Map;function u(d){let p=d.dataset.originalY;if($.has(p))return $.get(p);let h=JSON.parse(d.dataset.rowContributions||"{}");return $.set(p,h),h}function ie(){x.clear(),document.querySelectorAll("[data-collapse-key][data-original-y]").forEach(p=>{let h=p.dataset.collapseKey,q=parseFloat(p.dataset.originalY);x.has(h)||x.set(h,{originalY:q,elements:[]}),x.get(h).elements.push(p)})}function N(){L.clear(),document.querySelectorAll("[data-collapse-key][data-parent-key]").forEach(p=>{let h=p.dataset.collapseKey;if(L.has(h))return;let q=[],l=p.dataset.parentKey;for(;l;)q.push(l),l=document.querySelector('[data-collapse-key="'+l+'"]')?.dataset.parentKey||null;L.set(h,q)})}ie(),N();function B(d,p){p?(d.setAttribute("visibility","hidden"),d.classList.add("gantt-row-hidden")):(d.removeAttribute("visibility"),d.classList.remove("gantt-row-hidden"))}function ee(d){let p=[];return L.forEach((h,q)=>{h.includes(d)&&p.push(q)}),p}function te(d){let p=[];return L.forEach((h,q)=>{let l=h.indexOf(d);if(l===-1)return;let c=!0;for(let m=0;m<l;m++){let C=h[m],X=document.querySelector('[data-collapse-key="'+C+'"].project-label, [data-collapse-key="'+C+'"].issue-label, [data-collapse-key="'+C+'"].time-group-label');if(!X||X.dataset.expanded!=="true"){c=!1;break}}c&&p.push(q)}),p}function le(d,p){let h=document.querySelector('[data-collapse-key="'+d+'"].project-label, [data-collapse-key="'+d+'"].time-group-label, [data-collapse-key="'+d+'"].issue-label');if(!h||h.dataset.hasChildren!=="true")return;let q=h.dataset.expanded==="true",l=p==="expand"?!0:p==="collapse"?!1:!q;if(l===q)return;h.dataset.expanded=l?"true":"false";let c=h.querySelector(".collapse-toggle");c&&c.classList.toggle("expanded",l);let m=ee(d),C=l?te(d):[];if(m.length===0){v.postMessage({command:"collapseStateSync",collapseKey:d,isExpanded:l});return}let X=new Set(m),ce=new Set(C),se=x.get(d),xe=se?.originalY??0,qe=new Set,Le=0,Se=0,U=l?C:te(d),Ae=new Set(U);if(document.querySelectorAll(".zebra-stripe").forEach(g=>{let w=u(g);d in w&&Se===0&&(Se=parseFloat(g.dataset.originalY||"0"));for(let[T,j]of Object.entries(w))Ae.has(T)&&!qe.has(T)&&(Le+=parseFloat(j),qe.add(T))}),Le===0&&U.length>0){v.postMessage({command:"collapseStateSync",collapseKey:d,isExpanded:l}),v.postMessage({command:"requestRerender"});return}let re=l?Le:-Le,ve=xe;if(se&&se.elements.length>0){let w=(se.elements[0].getAttribute("transform")||"").match(/translate\([^,]+,\s*([-\d.]+)/);w&&(ve=parseFloat(w[1]))}let Te=ve+Z;l?C.forEach(g=>{let w=x.get(g);w&&(w.elements.forEach(T=>{let be=(T.getAttribute("transform")||"").match(/translate\(([-\d.]+)/),ke=be?be[1]:"0";T.setAttribute("transform","translate("+ke+", "+Te+")"),B(T,!1)}),Te+=Z)}):m.forEach(g=>{let w=x.get(g);w&&w.elements.forEach(T=>{B(T,!0)})}),x.forEach(({originalY:g,elements:w},T)=>{g>xe&&!X.has(T)&&w.forEach(j=>{let be=j.getAttribute("transform")||"",ke=be.match(/translate\(([-\d.]+)/),Xe=ke?ke[1]:"0",O=be.match(/translate\([^,]+,\s*([-\d.]+)/),We=(O?parseFloat(O[1]):g)+re;j.setAttribute("transform","translate("+Xe+", "+We+")")})});let Fe=document.querySelector(".gantt-labels svg");if(Fe){let w=parseFloat(Fe.getAttribute("height")||"0")+re;Fe.setAttribute("height",String(w))}[".gantt-col-status svg",".gantt-col-id svg",".gantt-col-start svg",".gantt-col-due svg",".gantt-col-assignee svg"].forEach(g=>{let w=document.querySelector(g);if(!w)return;let j=parseFloat(w.getAttribute("height")||"0")+re;w.setAttribute("height",String(j))});let de=document.querySelector(".gantt-timeline svg");if(de){let w=parseFloat(de.getAttribute("height")||"0")+re;de.setAttribute("height",w)}let ue=new Set;document.querySelectorAll('.project-label[data-has-children="true"], .time-group-label[data-has-children="true"], .issue-label[data-has-children="true"]').forEach(g=>{g.dataset.expanded==="false"&&ue.add(g.dataset.collapseKey)});let De=new Map,He=document.querySelectorAll(".zebra-stripe");He.forEach(g=>{let w=parseFloat(g.dataset.originalY||"0");if(De.has(w))return;let T=u(g),j=Object.keys(T),be=j.length>0&&j.every(O=>X.has(O)),ke=j.some(O=>X.has(O)),Xe=w>Se;if(be)De.set(w,{action:"toggle-visibility",hide:!l});else if(ke)if(l){let O=0;for(let[Pe,We]of Object.entries(T))(!X.has(Pe)||ce.has(Pe))&&(O+=parseFloat(We));De.set(w,{action:"expand",newHeight:O})}else{let O=0;for(let[Pe,We]of Object.entries(T))X.has(Pe)||(O+=parseFloat(We));De.set(w,{action:"shrink",newHeight:O})}else if(Xe){let O=parseFloat(g.getAttribute("y")||String(w));De.set(w,{action:"shift",newY:O+re})}}),He.forEach(g=>{let w=parseFloat(g.dataset.originalY||"0"),T=De.get(w);if(T)switch(T.action){case"toggle-visibility":B(g,T.hide);break;case"shrink":g.setAttribute("height",String(T.newHeight));break;case"expand":g.setAttribute("height",String(T.newHeight));break;case"shift":g.setAttribute("y",String(T.newY));break}});let y=Array.from(document.querySelectorAll(".zebra-stripe")).filter(g=>g.getAttribute("visibility")!=="hidden"),we=new Map;y.forEach(g=>{let w=parseFloat(g.getAttribute("y")||"0");we.has(w)||we.set(w,[]),we.get(w).push(g)}),Array.from(we.keys()).sort((g,w)=>g-w).forEach((g,w)=>{let T=w%2===0?"0.03":"0.06";we.get(g).forEach(j=>j.setAttribute("opacity",T))}),document.querySelectorAll(".indent-guide-line").forEach(g=>{let w=g.dataset.forParent,T=L.get(w)||[],j=ue.has(w)||T.some(be=>ue.has(be));if(B(g,j),!j){let be=x.get(w);if(be&&be.originalY>xe){let ke=parseFloat(g.getAttribute("y1")||"0"),Xe=parseFloat(g.getAttribute("y2")||"0");g.setAttribute("y1",ke+re),g.setAttribute("y2",Xe+re)}}}),document.querySelectorAll(".dependency-arrow").forEach(g=>{let w=g.dataset.from,T=g.dataset.to,j=document.querySelector('.issue-bar[data-issue-id="'+w+'"]'),be=document.querySelector('.issue-bar[data-issue-id="'+T+'"]'),ke=j?.classList.contains("gantt-row-hidden"),Xe=be?.classList.contains("gantt-row-hidden");B(g,ke||Xe)}),v.postMessage({command:"collapseStateSync",collapseKey:d,isExpanded:l})}if(pe){let d=R.find(p=>p.dataset.collapseKey===pe);d&&_(d,!0)}R.forEach((d,p)=>{d.addEventListener("click",h=>{if(h.target.closest?.(".collapse-toggle")||h.target.closest?.(".chevron-hit-area"))return;let q=d.dataset.issueId,l=d.classList.contains("project-label"),c=d.classList.contains("time-group-label"),m=d.dataset.collapseKey;if((l||c)&&m){_(d),d.dataset.hasChildren==="true"&&le(m);return}let C=h.target.classList?.contains("issue-text")||h.target.closest(".issue-text");q&&C?(_(d,!1,!1,!0),v.postMessage({command:"openIssue",issueId:parseInt(q,10)})):d.dataset.hasChildren==="true"&&m?(_(d),le(m)):_(d)}),d.addEventListener("keydown",h=>{let q=d.dataset.collapseKey,l=d.dataset.issueId?parseInt(d.dataset.issueId,10):NaN;switch(h.key){case"Enter":case" ":h.preventDefault(),isNaN(l)||v.postMessage({command:"openIssue",issueId:l});break;case"ArrowUp":{h.preventDefault();let c=H(p,-1);c&&_(c.label,!1,!0);break}case"ArrowDown":{h.preventDefault();let c=H(p,1);c&&_(c.label,!1,!0);break}case"ArrowLeft":if(h.preventDefault(),d.dataset.hasChildren==="true"&&d.dataset.expanded==="true")le(q,"collapse");else if(d.dataset.parentKey){let c=R.find(m=>m.dataset.collapseKey===d.dataset.parentKey);c&&_(c,!1,!0)}break;case"ArrowRight":if(h.preventDefault(),d.dataset.hasChildren==="true"&&d.dataset.expanded==="false")le(q,"expand");else if(d.dataset.hasChildren==="true"&&d.dataset.expanded==="true"){let c=R.find(m=>m.dataset.parentKey===q&&ye(m));c&&_(c,!1,!0)}break;case"Home":{h.preventDefault();let c=H(-1,1);c&&_(c.label,!1,!0);break}case"End":{h.preventDefault();let c=H(R.length,-1);c&&_(c.label,!1,!0);break}case"PageDown":{h.preventDefault();let c=p,m=0;for(;m<10&&c<R.length-1;){let C=H(c,1);if(!C)break;c=C.index,m++}m>0&&_(R[c],!1,!0);break}case"PageUp":{h.preventDefault();let c=p,m=0;for(;m<10&&c>0;){let C=H(c,-1);if(!C)break;c=C.index,m++}m>0&&_(R[c],!1,!0);break}case"Tab":if(!h.shiftKey&&!isNaN(l)){let c=document.querySelector(`.issue-bar[data-issue-id="${l}"]`);c&&(h.preventDefault(),c.focus(),ne(`Timeline bar for issue #${l}`))}break}})})}function mt(k){let{vscode:v,addDocListener:G,menuUndo:W,menuRedo:ne,undoStack:Z,redoStack:V,saveState:R,updateUndoRedoButtons:ae,announce:pe,scrollToAndHighlight:ye,scrollToToday:H}=k;G("keydown",u=>{let N=navigator.platform.toUpperCase().indexOf("MAC")>=0?u.metaKey:u.ctrlKey;if(!(u.target.tagName==="INPUT"||u.target.tagName==="SELECT"||u.target.tagName==="TEXTAREA"))if(N&&u.key==="z"&&!u.shiftKey)u.preventDefault(),W?.click();else if(N&&u.key==="z"&&u.shiftKey)u.preventDefault(),ne?.click();else if(N&&u.key==="y")u.preventDefault(),ne?.click();else if(u.key>="1"&&u.key<="5"){let B=document.getElementById("zoomSelect"),ee=["day","week","month","quarter","year"];B.value=ee[parseInt(u.key)-1],B.dispatchEvent(new Event("change"))}else if(u.key.toLowerCase()==="h")document.getElementById("menuHeatmap")?.click();else if(u.key.toLowerCase()==="y")document.getElementById("menuCapacity")?.click();else if(u.key.toLowerCase()==="i")document.getElementById("menuIntensity")?.click();else if(u.key.toLowerCase()==="d")document.getElementById("menuDeps")?.click();else if(u.key.toLowerCase()==="v"){let B=document.getElementById("viewFocusSelect");B.value=B.value==="project"?"person":"project",B.dispatchEvent(new Event("change"))}else if(u.key.toLowerCase()==="r")document.getElementById("refreshBtn")?.click();else if(u.key.toLowerCase()==="t")H();else if(u.key.toLowerCase()==="e")document.getElementById("menuExpand")?.click();else if(u.key.toLowerCase()==="c"&&!N)document.getElementById("menuCollapse")?.click();else if(u.key.toLowerCase()==="f"&&!N)u.preventDefault(),document.getElementById("menuFilterHealth")?.click();else if(u.key.toLowerCase()==="b"){u.preventDefault();let B=Array.from(document.querySelectorAll(".issue-bar[data-issue-id]")).filter(p=>p.querySelector(".blocker-badge"));if(B.length===0){pe("No blocked issues");return}let ee=document.activeElement?.closest(".issue-bar"),le=((ee?B.indexOf(ee):-1)+1)%B.length,d=B[le];ye(d.dataset.issueId),d.focus(),pe("Blocked issue "+(le+1)+" of "+B.length)}else if(u.key==="ArrowLeft"||u.key==="ArrowRight"){let B=document.activeElement?.closest(".issue-bar:not(.parent-bar)");if(!B)return;u.preventDefault();let ee=parseInt(B.dataset.issueId),te=B.dataset.startDate,le=B.dataset.dueDate;if(!te&&!le)return;let d=u.key==="ArrowRight"?1:-1,p=(l,c)=>{let m=new Date(l+"T00:00:00");return m.setDate(m.getDate()+c),m.toISOString().slice(0,10)},h=null,q=null;u.shiftKey&&le?q=p(le,d):u.altKey&&te?h=p(te,d):(te&&(h=p(te,d)),le&&(q=p(le,d))),(h||q)&&(R(),Z.push({issueId:ee,oldStartDate:h?te:null,oldDueDate:q?le:null,newStartDate:h,newDueDate:q}),V.length=0,ae(),v.postMessage({command:"updateDates",issueId:ee,startDate:h,dueDate:q}))}else u.key==="/"&&!N?(u.preventDefault(),_()):(u.key==="?"||u.shiftKey&&u.key==="/")&&(u.preventDefault(),$())});let J=null;function _(){J&&J.remove(),J=document.createElement("div"),J.className="quick-search",J.innerHTML=`
      <input type="text" placeholder="Search issues..." autofocus />
    `,document.body.appendChild(J);let u=J.querySelector("input");u.focus();let ie=Array.from(document.querySelectorAll(".issue-label"));u.addEventListener("input",()=>{let N=u.value.toLowerCase();ie.forEach(B=>{let ee=B.getAttribute("aria-label")?.toLowerCase()||"",te=N&&ee.includes(N);B.classList.toggle("search-match",te)})}),u.addEventListener("keydown",N=>{if(N.key==="Escape")x();else if(N.key==="Enter"){let B=document.querySelector(".issue-label.search-match");B&&(x(),B.focus(),ye(B.dataset.issueId))}}),u.addEventListener("blur",()=>setTimeout(x,150))}function x(){J&&(J.remove(),J=null,document.querySelectorAll(".search-match").forEach(u=>u.classList.remove("search-match")))}let L=null;function $(){if(L){L.remove(),L=null;return}L=document.createElement("div"),L.className="keyboard-help",L.innerHTML=`
      <div class="keyboard-help-content">
        <h3>Keyboard Shortcuts</h3>
        <div class="shortcut-grid">
          <div class="shortcut-section">
            <h4>Navigation</h4>
            <div><kbd>\u2191</kbd><kbd>\u2193</kbd> Move between issues</div>
            <div><kbd>Home</kbd><kbd>End</kbd> First/last issue</div>
            <div><kbd>PgUp</kbd><kbd>PgDn</kbd> Jump 10 rows</div>
            <div><kbd>Tab</kbd> Label \u2192 Bar</div>
            <div><kbd>Shift+Tab</kbd> Bar \u2192 Label</div>
          </div>
          <div class="shortcut-section">
            <h4>Date Editing</h4>
            <div><kbd>\u2190</kbd><kbd>\u2192</kbd> Move bar \xB11 day</div>
            <div><kbd>Shift+\u2190/\u2192</kbd> Resize end</div>
            <div><kbd>Alt+\u2190/\u2192</kbd> Resize start</div>
            <div><kbd>Ctrl+Z</kbd> Undo</div>
            <div><kbd>Ctrl+Y</kbd> Redo</div>
          </div>
          <div class="shortcut-section">
            <h4>View</h4>
            <div><kbd>1-5</kbd> Zoom levels</div>
            <div><kbd>H</kbd> Heatmap</div>
            <div><kbd>D</kbd> Dependencies</div>
            <div><kbd>C</kbd> Critical path</div>
            <div><kbd>T</kbd> Today</div>
          </div>
          <div class="shortcut-section">
            <h4>Health & Other</h4>
            <div><kbd>F</kbd> Cycle health filter</div>
            <div><kbd>B</kbd> Next blocked issue</div>
            <div><kbd>/</kbd> Quick search</div>
            <div><kbd>S</kbd> Cycle sort</div>
            <div><kbd>R</kbd> Refresh</div>
            <div><kbd>Esc</kbd> Clear/cancel</div>
          </div>
        </div>
        <p class="keyboard-help-close">Press <kbd>?</kbd> or <kbd>Esc</kbd> to close</p>
      </div>
    `,document.body.appendChild(L),L.addEventListener("click",u=>{u.target===L&&$()})}G("keydown",u=>{u.key==="Escape"&&L&&(u.stopImmediatePropagation(),$())})}var oe=acquireVsCodeApi(),Ze=!1;function Ve(k){Ze&&typeof performance<"u"&&performance.mark(k)}function nt(k,v,G){if(Ze&&typeof performance<"u")try{performance.measure(k,v,G);let W=performance.getEntriesByName(k,"measure");W.length>0&&console.log(`[Gantt Perf] ${k}: ${W[W.length-1].duration.toFixed(2)}ms`),performance.clearMarks(v),performance.clearMarks(G),performance.clearMeasures(k)}catch{}}function yt(){if(Ze){let k=document.getElementById("ganttRoot"),v=k?k.querySelectorAll("*").length:0,G=k?k.querySelectorAll("svg *").length:0;console.log(`[Gantt Perf] DOM nodes: ${v}, SVG elements: ${G}`)}}function bt(k){if(!k)return;let v=document.documentElement;v.style.setProperty("--gantt-header-height",`${k.headerHeight}px`),v.style.setProperty("--gantt-label-width",`${k.labelWidth}px`),v.style.setProperty("--gantt-id-column-width",`${k.idColumnWidth}px`),v.style.setProperty("--gantt-start-date-column-width",`${k.startDateColumnWidth}px`),v.style.setProperty("--gantt-status-column-width",`${k.statusColumnWidth}px`),v.style.setProperty("--gantt-due-date-column-width",`${k.dueDateColumnWidth}px`),v.style.setProperty("--gantt-assignee-column-width",`${k.assigneeColumnWidth}px`),v.style.setProperty("--gantt-sticky-left-width",`${k.stickyLeftWidth}px`)}function vt({addDocListener:k,addWinListener:v}){let G=document.getElementById("ganttRoot"),W=document.getElementById("ganttTooltip"),ne=W?.querySelector(".gantt-tooltip-content");if(!G||!W||!ne)return;let Z=l=>l?String(l).replace(/\r\n/g,`
`).trimEnd():"";function V(){G.querySelectorAll("svg title").forEach(l=>{let c=l.parentElement,m=Z(l.textContent);c&&m&&(c.dataset.tooltip=m),l.remove()})}function R(){G.querySelectorAll("[title]").forEach(l=>{if(l.tagName.toLowerCase()==="title")return;let c=Z(l.getAttribute("title"));l.removeAttribute("title"),c&&(l.dataset.tooltip=c)})}function ae(){V(),R()}function pe(l){let c=l.findIndex(C=>C.trim().startsWith("#"));return c>=0?c:l.filter(C=>C.trim()).length>1?l.findIndex(C=>C.trim()):-1}function ye(l){ne.textContent="";let c=Z(l);if(!c)return;let m=c.split(`
`),C=pe(m),X=!1;m.forEach((se,xe)=>{let qe=se.trim();if(!qe){if(!X){let U=document.createElement("div");U.className="gantt-tooltip-spacer",ne.appendChild(U),X=!0}return}if(qe==="---"){let U=document.createElement("div");U.className="gantt-tooltip-divider",ne.appendChild(U),X=!1;return}let Le=qe.match(/^cf:([^:]+):(.*)$/);if(Le){let U=Le[1].trim(),Ae=Le[2].trim(),re=document.createElement("div");re.className="gantt-tooltip-line";let ve=document.createElement("span");ve.className="gantt-tooltip-key",ve.textContent=`${U}: `,re.appendChild(ve),Ae&&re.appendChild(document.createTextNode(Ae)),ne.appendChild(re),X=!1;return}let Se=document.createElement("div");Se.className="gantt-tooltip-line",xe===C&&Se.classList.add("gantt-tooltip-title");let Be=qe.match(/^Open in Browser:\s*(\S+)/);if(Be&&/^https?:\/\//i.test(Be[1])){Se.appendChild(document.createTextNode("Open in Browser: "));let U=document.createElement("a");U.href=Be[1],U.textContent=Be[1],U.target="_blank",U.rel="noopener noreferrer",Se.appendChild(U)}else Se.textContent=se;ne.appendChild(Se),X=!1});let ce=ne.lastElementChild;ce&&ce.classList.contains("gantt-tooltip-spacer")&&ce.remove()}let H=null,J=null,_=null,x={x:0,y:0};function L(l){x={x:l.clientX,y:l.clientY}}function $(){J&&(clearTimeout(J),J=null)}function u(){_&&(clearTimeout(_),_=null)}function ie(l){return l&&(l===W||W.contains(l))}function N(l){return l&&H&&(l===H||H.contains(l))}function B(){if(!x)return!1;let l=document.elementFromPoint(x.x,x.y);return ie(l)||N(l)}let ee=300;function te(l){u(),_=setTimeout(()=>{_=null,!(!H||H!==l)&&B()&&p(l,x.x,x.y)},ee)}function le(){$(),J=setTimeout(()=>{H&&(B()||h())},300)}function d(l,c){let X=W.getBoundingClientRect(),ce=l+8,se=c+8;ce+X.width>window.innerWidth-8&&(ce=l-X.width-8),se+X.height>window.innerHeight-8&&(se=c-X.height-8),ce=Math.max(8,Math.min(ce,window.innerWidth-X.width-8)),se=Math.max(8,Math.min(se,window.innerHeight-X.height-8)),W.style.left=`${Math.round(ce)}px`,W.style.top=`${Math.round(se)}px`}function p(l,c,m){let C=l.dataset.tooltip;C&&(ye(C),W.classList.add("visible"),W.setAttribute("aria-hidden","false"),d(c,m))}function h(l=!1){u(),$(),W.classList.remove("visible"),W.setAttribute("aria-hidden","true"),l||(H=null)}function q(l){if(!l||l===W||W.contains(l))return null;let c=l.closest?.("[data-tooltip], [title]");if(!c||!G.contains(c))return null;if(c.hasAttribute("title")){let m=Z(c.getAttribute("title"));c.removeAttribute("title"),m&&(c.dataset.tooltip=m)}return c.dataset.tooltip?c:null}ae(),k("pointerover",l=>{if(L(l),ie(l.target)){$(),u();return}let c=q(l.target);if(!c){u();return}$(),H!==c?(H=c,W.classList.contains("visible")&&h(!0),te(c)):W.classList.contains("visible")||te(c)},!0),k("pointermove",l=>{H&&(L(l),J&&B()&&$())},!0),k("pointerout",l=>{if(!H||(L(l),u(),!N(l.target)&&!ie(l.target)))return;let c=l.relatedTarget;ie(c)||N(c)||le()},!0),k("scroll",()=>{H&&h()},!0),k("keydown",()=>{H&&h()},!0),v("blur",()=>{H&&h()})}function gt(k){if(!k)return;k.state&&(Ze=k.state.perfDebug??!1),Ve("render-start");let v=document.getElementById("ganttRoot");v&&(bt(k.state),Ve("innerHTML-start"),v.innerHTML=k.html||"",Ve("innerHTML-end"),nt("innerHTML","innerHTML-start","innerHTML-end"),wt(k.state),Ve("render-end"),nt("render","render-start","render-end"),yt())}window.addEventListener("message",k=>{let v=k.data;if(v){if(v.command==="render"){gt(v.payload);return}window.__ganttHandleExtensionMessage&&window.__ganttHandleExtensionMessage(v)}});var ht=window.__GANTT_INITIAL_PAYLOAD__;ht&&gt(ht);oe.postMessage({command:"webviewReady"});function wt(k){if(Ve("initializeGantt-start"),!k)return;let{timelineWidth:v,minDateMs:G,maxDateMs:W,totalDays:ne,extendedRelationTypes:Z,redmineBaseUrl:V,minimapBarsData:R,minimapHeight:ae,minimapBarHeight:pe,minimapTodayX:ye,extScrollLeft:H,extScrollTop:J,labelWidth:_,leftExtrasWidth:x,healthFilter:L,sortBy:$,sortOrder:u,selectedCollapseKey:ie,barHeight:N,todayX:B,todayInRange:ee}=k,te=v/ne;window._ganttCleanup&&window._ganttCleanup();let le=[],d=[];function p(e,t,o){document.addEventListener(e,t,o),le.push({type:e,handler:t,options:o})}function h(e,t,o){window.addEventListener(e,t,o),d.push({type:e,handler:t,options:o})}window._ganttCleanup=()=>{le.forEach(e=>document.removeEventListener(e.type,e.handler,e.options)),d.forEach(e=>window.removeEventListener(e.type,e.handler,e.options)),window.__ganttHandleExtensionMessage=null};function q(e){setTimeout(()=>{document.addEventListener("click",function t(o){e.contains(o.target)||(e.remove(),document.removeEventListener("click",t))})},0)}function l(e){return Math.round(e/te)*te}function c(e){let t=document.getElementById("liveRegion");t&&(t.textContent=e)}let m=document.getElementById("ganttScroll"),C=document.getElementById("ganttLeftHeader"),X=document.getElementById("ganttLabels"),ce=document.getElementById("ganttTimeline"),se=document.getElementById("menuUndo"),xe=document.getElementById("menuRedo"),qe=document.getElementById("minimapSvg"),Le=document.getElementById("minimapViewport"),{updateMinimapPosition:Se,updateMinimapViewport:Be}=dt({timelineWidth:v,minimapBarsData:R,minimapHeight:ae,minimapBarHeight:pe,minimapTodayX:ye,ganttScroll:m,minimapSvg:qe,minimapViewport:Le,addDocListener:p}),U=oe.getState()||{undoStack:[],redoStack:[],labelWidth:_,scrollLeft:null,scrollTop:null,centerDateMs:null},Ae=U.undoStack||[],re=U.redoStack||[],ve=U.scrollLeft??(H>0?H:null),Te=U.scrollTop??(J>0?J:null),Fe=U.centerDateMs;function Je(){if(!m)return null;let t=document.querySelector(".gantt-body .gantt-sticky-left")?.offsetWidth??0,o=m.clientWidth-t,b=(m.scrollLeft+o/2)/v;return G+b*(W-G)}function de(e){if(!m)return;let o=(e-G)/(W-G)*v,b=document.querySelector(".gantt-body .gantt-sticky-left")?.offsetWidth??0,P=m.clientWidth-b;m.scrollLeft=Math.max(0,o-P/2)}function ue(){oe.setState({undoStack:Ae,redoStack:re,labelWidth:X?.offsetWidth||_,scrollLeft:null,scrollTop:m?.scrollTop??null,centerDateMs:Je()})}let De=ue;function He(){se&&se.toggleAttribute("disabled",Ae.length===0),xe&&xe.toggleAttribute("disabled",re.length===0),ue()}if(U.labelWidth&&C&&X){C.style.width=U.labelWidth+"px",X.style.width=U.labelWidth+"px";let e=document.querySelector(".capacity-ribbon-label");e&&(e.style.width=U.labelWidth+x+"px")}let y=!0,we=!1,$e=e=>{we=e},g=null;m&&m.addEventListener("scroll",()=>{cancelAnimationFrame(g),g=requestAnimationFrame(()=>{Be(),y||ue()})},{passive:!0}),requestAnimationFrame(()=>He()),window.__ganttHandleExtensionMessage=e=>{if(e.command==="setHeatmapState"){let t=document.querySelector(".heatmap-layer"),o=document.querySelector(".weekend-layer"),f=document.getElementById("menuHeatmap");e.enabled?(t&&t.classList.remove("hidden"),o&&o.classList.add("hidden"),f&&f.classList.add("active")):(t&&t.classList.add("hidden"),o&&o.classList.remove("hidden"),f&&f.classList.remove("active"))}else if(e.command==="setDependenciesState"){let t=document.querySelector(".dependency-layer"),o=document.getElementById("menuDeps");e.enabled?(t&&t.classList.remove("hidden"),o&&o.classList.add("active")):(t&&t.classList.add("hidden"),o&&o.classList.remove("active"))}else if(e.command==="setCapacityRibbonState"){let t=document.querySelector(".capacity-ribbon"),o=document.getElementById("menuCapacity");e.enabled?(t&&t.classList.remove("hidden"),o&&o.classList.add("active")):(t&&t.classList.add("hidden"),o&&o.classList.remove("active"))}else if(e.command==="setIntensityState"){let t=document.querySelector(".gantt-container"),o=document.getElementById("menuIntensity");e.enabled?(t?.classList.add("intensity-enabled"),o&&o.classList.add("active")):(t?.classList.remove("intensity-enabled"),o&&o.classList.remove("active"))}else if(e.command==="pushUndoAction")Ae.push(e.action),re.length=0,He(),ue();else if(e.command==="updateRelationId"){let t=e.stack==="undo"?Ae:re;if(t.length>0){let o=t[t.length-1];o.type==="relation"&&(o.relationId=e.newRelationId,ue())}}else if(e.command==="scrollToIssue"){let t=e.issueId,o=document.querySelector('.issue-label[data-issue-id="'+t+'"]'),f=document.querySelector('.issue-bar[data-issue-id="'+t+'"]'),b=document.getElementById("ganttScroll"),he=document.querySelector(".gantt-header-row")?.getBoundingClientRect().height||60;if(!b)return;let Ee=b.scrollTop,ge=b.scrollLeft;if(o){let _e=o.closest(".gantt-row");if(_e){let Ne=_e.offsetTop,Ue=_e.getBoundingClientRect().height,Ge=b.clientHeight-he;Ee=Math.max(0,Ne-he-(Ge-Ue)/2)}o.focus(),o.classList.add("highlighted"),setTimeout(()=>o.classList.remove("highlighted"),2e3)}if(f){let _e=parseFloat(f.getAttribute("data-start-x")||"0"),Ue=parseFloat(f.getAttribute("data-end-x")||"0")-_e,Ge=b.clientWidth,pt=document.querySelector(".gantt-sticky-left")?.getBoundingClientRect().width||0,ct=Ge-pt;Ue<=ct-100?ge=_e-(ct-Ue)/2:ge=_e-50,ge=Math.max(0,ge),f.classList.add("highlighted"),setTimeout(()=>f.classList.remove("highlighted"),2e3)}b.scrollTo({left:ge,top:Ee,behavior:"smooth"})}},document.getElementById("lookbackSelect")?.addEventListener("change",e=>{oe.postMessage({command:"setLookback",years:e.target.value})}),document.getElementById("zoomSelect")?.addEventListener("change",e=>{De(),oe.postMessage({command:"setZoom",zoomLevel:e.target.value})}),document.getElementById("viewFocusSelect")?.addEventListener("change",e=>{oe.postMessage({command:"setViewFocus",focus:e.target.value})}),document.getElementById("projectSelector")?.addEventListener("change",e=>{let t=e.target.value,o=t?parseInt(t,10):null;oe.postMessage({command:"setSelectedProject",projectId:o})}),document.getElementById("focusSelector")?.addEventListener("change",e=>{let t=e.target.value;oe.postMessage({command:"setSelectedAssignee",assignee:t||null})}),document.getElementById("filterAssignee")?.addEventListener("change",e=>{let t=e.target.value;oe.postMessage({command:"setFilter",filter:{assignee:t}})}),document.getElementById("filterStatus")?.addEventListener("change",e=>{let t=e.target.value;oe.postMessage({command:"setFilter",filter:{status:t}})}),document.getElementById("menuFilterHealth")?.addEventListener("click",()=>{let e=["all","critical","warning","healthy"],t=L,f=(e.indexOf(t)+1)%e.length;oe.postMessage({command:"setHealthFilter",health:e[f]})}),document.querySelectorAll(".gantt-col-header.sortable").forEach(e=>{e.addEventListener("click",()=>{let t=e.dataset.sort;t===$?u==="asc"?oe.postMessage({command:"setSort",sortOrder:"desc"}):oe.postMessage({command:"setSort",sortBy:null}):oe.postMessage({command:"setSort",sortBy:t,sortOrder:"asc"})})}),document.getElementById("menuHeatmap")?.addEventListener("click",()=>{document.getElementById("menuHeatmap")?.hasAttribute("disabled")||(ue(),oe.postMessage({command:"toggleWorkloadHeatmap"}))}),document.getElementById("menuCapacity")?.addEventListener("click",()=>{document.getElementById("menuCapacity")?.hasAttribute("disabled")||(ue(),oe.postMessage({command:"toggleCapacityRibbon"}))}),document.getElementById("menuIntensity")?.addEventListener("click",()=>{document.getElementById("menuIntensity")?.hasAttribute("disabled")||(ue(),oe.postMessage({command:"toggleIntensity"}))}),document.getElementById("overloadBadge")?.addEventListener("click",e=>{e.stopPropagation();let t=e.currentTarget,o=parseInt(t.dataset.firstOverloadMs||"0",10);o>0&&(de(o),ue())}),document.querySelectorAll(".capacity-day-bar-group").forEach(e=>{e.addEventListener("click",t=>{let o=parseInt(t.currentTarget.dataset.dateMs||"0",10);o>0&&(de(o),ue())})}),document.getElementById("menuDeps")?.addEventListener("click",()=>{ue(),oe.postMessage({command:"toggleDependencies"})});let j=document.querySelector(".gantt-container");function be(){let e=new Map,t=new Map;return document.querySelectorAll(".dependency-arrow").forEach(o=>{if(!(o.classList.contains("rel-blocks")||o.classList.contains("rel-precedes")))return;let b=o.dataset.from,P=o.dataset.to;e.has(b)||e.set(b,[]),e.get(b).push(P),t.has(P)||t.set(P,[]),t.get(P).push(b)}),{graph:e,reverseGraph:t}}let ke=null;function Xe(e,t,o){let f=new Set([e]),b=[e];for(;b.length>0;){let he=b.shift(),Ee=t.get(he)||[];for(let ge of Ee)f.has(ge)||(f.add(ge),b.push(ge))}let P=[e];for(;P.length>0;){let he=P.shift(),Ee=o.get(he)||[];for(let ge of Ee)f.has(ge)||(f.add(ge),P.push(ge))}return f}function O(e){if(Pe(),!e)return;ke=e;let{graph:t,reverseGraph:o}=be(),f=Xe(e,t,o);j.classList.add("focus-mode"),document.querySelectorAll(".issue-bar").forEach(b=>{f.has(b.dataset.issueId)&&b.classList.add("focus-highlighted")}),document.querySelectorAll(".issue-label").forEach(b=>{f.has(b.dataset.issueId)&&b.classList.add("focus-highlighted")}),document.querySelectorAll(".dependency-arrow").forEach(b=>{f.has(b.dataset.from)&&f.has(b.dataset.to)&&b.classList.add("focus-highlighted")}),c(`Focus: ${f.size} issue${f.size!==1?"s":""} in dependency chain`)}function Pe(){ke=null,j.classList.remove("focus-mode"),document.querySelectorAll(".focus-highlighted").forEach(e=>e.classList.remove("focus-highlighted"))}let We=()=>ke,fe=new Set,Oe=null,n=document.getElementById("selectionCount"),a=Array.from(document.querySelectorAll(".issue-bar")),s=new Map;a.forEach(e=>{let t=e.dataset.issueId;t&&(s.has(t)||s.set(t,[]),s.get(t).push(e))});function r(e){e.forEach(t=>{let o=s.get(t);o&&o.forEach(f=>f.classList.toggle("selected",fe.has(t)))}),fe.size>0?(n.textContent=`${fe.size} selected`,n.classList.remove("hidden"),j.classList.add("multi-select-mode")):(n.classList.add("hidden"),j.classList.remove("multi-select-mode"))}function i(){a.forEach(e=>{e.classList.toggle("selected",fe.has(e.dataset.issueId))}),fe.size>0?(n.textContent=`${fe.size} selected`,n.classList.remove("hidden"),j.classList.add("multi-select-mode")):(n.classList.add("hidden"),j.classList.remove("multi-select-mode"))}function A(){let e=[...fe];fe.clear(),Oe=null,r(e)}function M(e){fe.has(e)?fe.delete(e):fe.add(e),Oe=e,r([e])}function E(e,t){let o=a.findIndex(Ee=>Ee.dataset.issueId===e),f=a.findIndex(Ee=>Ee.dataset.issueId===t);if(o===-1||f===-1)return;let b=Math.min(o,f),P=Math.max(o,f),he=[];for(let Ee=b;Ee<=P;Ee++){let ge=a[Ee].dataset.issueId;fe.has(ge)||(fe.add(ge),he.push(ge))}r(he)}function K(){a.forEach(e=>fe.add(e.dataset.issueId)),i(),c(`Selected all ${fe.size} issues`)}a.forEach(e=>{e.addEventListener("mousedown",t=>{if(!t.ctrlKey&&!t.metaKey&&!t.shiftKey||t.target.classList.contains("drag-handle")||t.target.classList.contains("link-handle"))return;t.preventDefault(),t.stopPropagation();let o=e.dataset.issueId;t.shiftKey&&Oe?E(Oe,o):M(o)})}),p("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="a"&&(e.preventDefault(),K()),e.key==="Escape"&&fe.size>0&&(e.stopImmediatePropagation(),A(),c("Selection cleared"))}),document.getElementById("refreshBtn")?.addEventListener("click",()=>{document.getElementById("loadingOverlay")?.classList.add("visible"),oe.postMessage({command:"refresh"})});function D(e,t,o,f,b){document.querySelector(".relation-picker")?.remove();let P=document.createElement("div");P.className="relation-picker";let he=150,Ee=100,ge=Math.min(e,window.innerWidth-he-10),_e=Math.min(t,window.innerHeight-Ee-10);P.style.left=Math.max(10,ge)+"px",P.style.top=Math.max(10,_e)+"px";let Ne=document.createElement("div");Ne.style.padding="6px 12px",Ne.style.fontSize="11px",Ne.style.opacity="0.7",Ne.textContent=`#${f} \u2192 #${b}`,P.appendChild(Ne);let Ue=document.createElement("button");Ue.textContent="\u{1F5D1}\uFE0F Delete relation",Ue.addEventListener("click",()=>{ue(),oe.postMessage({command:"deleteRelation",relationId:o}),P.remove()}),P.appendChild(Ue);let Ge=document.createElement("button");Ge.textContent="Cancel",Ge.addEventListener("click",()=>P.remove()),P.appendChild(Ge),document.body.appendChild(P),q(P)}let F=new Map,S=new Map,I=new Map,Y=new Map,me=new Map,Ie=!1;function Ke(){document.querySelectorAll(".issue-bar").forEach(e=>{let t=e.dataset.issueId;t&&(F.has(t)||F.set(t,[]),F.get(t).push(e))}),document.querySelectorAll(".issue-label").forEach(e=>{let t=e.dataset.issueId;t&&(S.has(t)||S.set(t,[]),S.get(t).push(e))}),document.querySelectorAll(".dependency-arrow").forEach(e=>{let t=e.dataset.from,o=e.dataset.to;t&&(I.has(t)||I.set(t,[]),I.get(t).push(e)),o&&(I.has(o)||I.set(o,[]),I.get(o).push(e))}),document.querySelectorAll(".project-label").forEach(e=>{let t=e.dataset.collapseKey;t&&(Y.has(t)||Y.set(t,[]),Y.get(t).push(e))}),document.querySelectorAll(".aggregate-bars").forEach(e=>{let t=e.dataset.collapseKey;t&&(me.has(t)||me.set(t,[]),me.get(t).push(e))}),Ie=!0}typeof requestIdleCallback<"u"?requestIdleCallback(()=>Ke(),{timeout:100}):setTimeout(Ke,0);let Re=[];function Ye(){document.body.classList.remove("hover-focus","dependency-hover"),Re.forEach(e=>e.classList.remove("hover-highlighted","hover-source")),Re=[]}function ze(e){document.body.classList.add("hover-focus");let t=Ie?F.get(e)||[]:document.querySelectorAll('.issue-bar[data-issue-id="'+e+'"]'),o=Ie?S.get(e)||[]:document.querySelectorAll('.issue-label[data-issue-id="'+e+'"]'),f=Ie?I.get(e)||[]:document.querySelectorAll('.dependency-arrow[data-from="'+e+'"], .dependency-arrow[data-to="'+e+'"]');t.forEach(b=>{b.classList.add("hover-highlighted"),Re.push(b)}),o.forEach(b=>{b.classList.add("hover-highlighted"),Re.push(b)}),f.forEach(b=>{b.classList.add("hover-highlighted"),Re.push(b)})}function Me(e){document.body.classList.add("hover-focus");let t=Ie?Y.get(e)||[]:document.querySelectorAll('.project-label[data-collapse-key="'+e+'"]'),o=Ie?me.get(e)||[]:document.querySelectorAll('.aggregate-bars[data-collapse-key="'+e+'"]');t.forEach(f=>{f.classList.add("hover-highlighted"),Re.push(f)}),o.forEach(f=>{f.classList.add("hover-highlighted"),Re.push(f)})}let z=document.querySelector(".gantt-timeline svg"),Q=document.querySelector(".gantt-labels svg");if(z&&(z.addEventListener("mouseenter",e=>{let t=e.target.closest(".issue-bar"),o=e.target.closest(".aggregate-bars"),f=e.target.closest(".dependency-arrow");if(t){let b=t.dataset.issueId;b&&ze(b)}else if(o){let b=o.dataset.collapseKey;b&&Me(b)}else if(f){let b=f.dataset.from,P=f.dataset.to;document.body.classList.add("dependency-hover"),f.classList.add("hover-source"),Re.push(f),b&&ze(b),P&&ze(P)}},!0),z.addEventListener("mouseleave",e=>{let t=e.target.closest(".issue-bar"),o=e.target.closest(".aggregate-bars"),f=e.target.closest(".dependency-arrow");(t||o||f)&&Ye()},!0)),Q&&(Q.addEventListener("mouseenter",e=>{let t=e.target.closest(".issue-label"),o=e.target.closest(".project-label");if(t){let f=t.dataset.issueId;f&&ze(f)}else if(o){let f=o.dataset.collapseKey;f&&Me(f)}},!0),Q.addEventListener("mouseleave",e=>{let t=e.target.closest(".issue-label"),o=e.target.closest(".project-label");(t||o)&&Ye()},!0)),z){let t=function(){document.querySelectorAll(".dependency-arrow.selected").forEach(o=>o.classList.remove("selected")),document.body.classList.remove("arrow-selection-mode"),document.querySelectorAll(".arrow-connected").forEach(o=>o.classList.remove("arrow-connected")),e=null};var St=t;z.addEventListener("contextmenu",o=>{let f=o.target.closest(".dependency-arrow");if(!f)return;o.preventDefault();let b=parseInt(f.dataset.relationId),P=f.dataset.from,he=f.dataset.to;D(o.clientX,o.clientY,b,P,he)});let e=null;z.addEventListener("click",o=>{let f=o.target.closest(".dependency-arrow");if(e&&(e.classList.remove("selected"),document.body.classList.remove("arrow-selection-mode"),document.querySelectorAll(".arrow-connected").forEach(he=>he.classList.remove("arrow-connected")),e=null),!f)return;o.stopPropagation(),e=f,f.classList.add("selected"),document.body.classList.add("arrow-selection-mode");let b=f.dataset.from,P=f.dataset.to;document.querySelectorAll(`.issue-bar[data-issue-id="${b}"], .issue-bar[data-issue-id="${P}"]`).forEach(he=>he.classList.add("arrow-connected")),document.querySelectorAll(`.issue-label[data-issue-id="${b}"], .issue-label[data-issue-id="${P}"]`).forEach(he=>he.classList.add("arrow-connected")),c(`Selected relation from #${b} to #${P}`)}),window._ganttArrowClickHandler&&document.removeEventListener("click",window._ganttArrowClickHandler),window._ganttArrowClickHandler=o=>{(e||document.querySelector(".dependency-arrow.selected"))&&!o.target.closest(".dependency-arrow")&&!o.target.closest(".blocks-badge-group")&&!o.target.closest(".blocker-badge")&&t()},document.addEventListener("click",window._ganttArrowClickHandler),window._ganttArrowKeyHandler&&document.removeEventListener("keydown",window._ganttArrowKeyHandler),window._ganttArrowKeyHandler=o=>{let f=e||document.querySelector(".dependency-arrow.selected");o.key==="Escape"&&f&&(o.stopImmediatePropagation(),t())},document.addEventListener("keydown",window._ganttArrowKeyHandler)}ut({vscode:oe,menuUndo:se,menuRedo:xe,addDocListener:p,closeOnOutsideClick:q,announce:c,saveState:ue,updateUndoRedoButtons:He,undoStack:Ae,redoStack:re,selectedIssues:fe,clearSelection:A,allIssueBars:a,redmineBaseUrl:V,extendedRelationTypes:Z,minDateMs:G,maxDateMs:W,timelineWidth:v,dayWidth:te,barHeight:N,ganttScroll:m,snapToDay:l,focusOnDependencyChain:O,clearFocus:Pe,getFocusedIssueId:We,scrollToAndHighlight:je,setAllowScrollChange:$e}),ft({vscode:oe,addDocListener:p,addWinListener:h,announce:c,barHeight:N,selectedCollapseKey:ie});function Ce(){if(!ee){oe.postMessage({command:"todayOutOfRange"});return}if(m){let t=document.querySelector(".gantt-body .gantt-sticky-left")?.offsetWidth??0,o=m.clientWidth-t;m.scrollLeft=Math.max(0,B-o/2)}}function je(e){if(!e)return;we=!0;let t=document.querySelector('.issue-label[data-issue-id="'+e+'"]'),o=document.querySelector('.issue-bar[data-issue-id="'+e+'"]');if(t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.classList.add("highlighted"),setTimeout(()=>t.classList.remove("highlighted"),1500)),o&&m){let f=o.getBoundingClientRect(),b=m.getBoundingClientRect(),P=m.scrollLeft+f.left-b.left-100;m.scrollTo({left:Math.max(0,P),behavior:"smooth"}),o.classList.add("highlighted"),setTimeout(()=>o.classList.remove("highlighted"),1500)}}mt({vscode:oe,addDocListener:p,menuUndo:se,menuRedo:xe,undoStack:Ae,redoStack:re,saveState:ue,updateUndoRedoButtons:He,announce:c,scrollToAndHighlight:je,scrollToToday:Ce}),vt({addDocListener:p,addWinListener:h,ganttScroll:m}),requestAnimationFrame(()=>{if(Fe!==null&&m){let e=Math.max(G,Math.min(W,Fe));de(e),Te!==null&&(m.scrollTop=Te),Fe=null,Te=null}else ve!==null&&m?(m.scrollLeft=ve,Te!==null&&(m.scrollTop=Te),ve=null,Te=null):Ce();Be(),y=!1}),document.getElementById("todayBtn")?.addEventListener("click",Ce);let at=document.getElementById("resizeHandle"),ot=document.getElementById("resizeHandleHeader"),Qe=!1,rt=0,it=0,et=null;function lt(e,t){Qe=!0,et=t,rt=e.clientX,it=X.offsetWidth,t.classList.add("dragging"),document.body.classList.add("cursor-col-resize","user-select-none"),e.preventDefault()}at?.addEventListener("mousedown",e=>lt(e,at)),ot?.addEventListener("mousedown",e=>lt(e,ot));let tt=!1,st=null;p("mousemove",e=>{Qe&&(st=e,!tt&&(tt=!0,requestAnimationFrame(()=>{if(tt=!1,!st)return;let t=st.clientX-rt,o=Math.min(600,Math.max(120,it+t));if(C&&(C.style.width=o+"px"),X){X.style.width=o+"px";let b=X.querySelector("svg");b&&b.setAttribute("width",String(o))}let f=document.querySelector(".capacity-ribbon-label");f&&(f.style.width=o+x+"px"),Se()})))}),p("mouseup",()=>{Qe&&(Qe=!1,et?.classList.remove("dragging"),et=null,document.body.classList.remove("cursor-col-resize","user-select-none"),ue())}),requestAnimationFrame(()=>{document.getElementById("loadingOverlay")?.classList.remove("visible")}),Ve("initializeGantt-end"),nt("initializeGantt","initializeGantt-start","initializeGantt-end")}})();
